<html>
<head>
  <title>peer - scylla</title>
  <script src="http://cdn.peerjs.com/0.3/peer.js"></script>
</head>
<body onload="init()">

  <div id="name">scylla</div><br>
  <input id="peer-id" type="text" name="peer id"></input><input type="button" onclick="connect()" value="connect"></input><br>
  <br>
  <input id="peer-msg" type="text" name="peer msg"></input><input type="button" onclick="send()" value="send"></input><br>
  <br>
  words: <span id="data-holder">-</span>
  <div id="status">status: offline</div>

  <script>
  var peer;
  var link;
  var status_elem;
  var data_elem;

  var my_peer_id = 'scylla';
  var api_key = 'c83xx8lhssoo5hfr';

  function init(){
    //this is where we connect to a custom peerServer
    // peer = new Peer(my_peer_id, {host: 'localhost', port: 2046, path: '/peer'});

    //this is where we connect to a server hosted by peerJS - go to http://peerjs.com/peerserver to get an api key
    peer = new Peer(my_peer_id, {key: api_key});

    status_elem = document.getElementById('status');
    data_elem = document.getElementById('data-holder');
    console.log('connected', peer);
    status_elem.innerHTML = 'status: connected to server';

    peer.on('connection', function(connect){
      connect.on('data', function(data){
        data_elem.innerHTML = data;
      });
    });
  }

  function connect(){
    var id = document.getElementById('peer-id').value;

    link = peer.connect(id);
    status_elem.innerHTML = 'status: connecting to '+id+'...';

    link.on('open', function(){
      status_elem.innerHTML = 'status: opened connection to '+id;
    });
  }

  function send(){
    var msg = document.getElementById('peer-msg').value;
    link.send(msg);
  }

  </script>
</body>
</html>
